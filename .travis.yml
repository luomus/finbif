language: r
os: linux
dist: xenial
cache:
- packages
addons:
  apt:
    packages:
    - libudunits2-dev
    - libgdal-dev
    - libgeos-dev
    - libproj-dev
  homebrew:
    packages:
    - udunits
    - cairo
r_packages: goodpractice
jobs:
  include:
  - r: oldrel
  - r: release
    after_success:
    - R -e "covr::codecov(line_exclusions = list('R/finbif_request_token.R' = 35:72),
      branch = Sys.getenv('TRAVIS_BRANCH'))"
    - R -e "goodpractice::gp(checks = grep('(rcmdcheck|covr)', goodpractice::all_checks(),
      invert = TRUE, value = TRUE))"
    before_deploy: Rscript -e 'remotes::install_cran("pkgdown")'
    deploy:
      provider: script
      script: Rscript -e 'pkgdown::deploy_site_github(verbose = TRUE)'
      cleanup: false
  - r: devel
  - r: release
    os: osx
notifications:
  slack:
    rooms:
      secure: hJ8KlJunycwnva8Ky5Nwlh+TJzjwKKP/7nmWzvWaArm0tob0EUdRwO2mwosPt7iXF0e63MweztdGtZbTwDcZam0Uw7mav9AkZFtx9Mp5fbRF+CHigk+zZW/XFtLOMMgQXT8o9JfBuBiyBZD10q39HHLYX7vZL/0FLWj/j5/EZh2tRPwSt36DfuJqH8iSbCla4M4YgqFYC97TYuDft3QDOCdKDe5VHdYIUtnyTdE1fLos/vI+Kvu95IeB2WEn/kAsqYZrG92679bLXr1EkV69303jIRjDIE/L5Ic/vjlDCIVIL0FrvjEcJPDyZvg3jPbLO8KyLf/guCxUDVXGChxGhmNGIB5lBHPt94ecmN9VKb0o0XrvumRJ2N0mTEGaQkFgAMSviSNbv6+zFWf9MCSY5f+USCkszASs3VEXgNAYL/Tlonp3Qx9qepCGnCvWI3etk2T8E3MT0wT4d/Ja1720NalHz94Z2TLKGQRh1OU+gZ9HA1Z0P8lCsvF0rZi/Yjnni8M2C5JgxaoifS+8yQ4ZfAI6ZWilUpe/B0uDD8XeYrzb6/8UkucrrHQe9wgZv2pfepdXQmxb7a0sBwul554n7wlvDcrraQbNgESsC2CJ9ZVrn08+IGpQ8g6ICotc8KEg3QBGwO/T/X5hUjzrDavZ1MTOk0Bl95pV7qx24XbYJn8=
    on_success: always
    on_failure: always
